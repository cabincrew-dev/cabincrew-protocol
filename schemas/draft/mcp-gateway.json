{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "mcp-gateway",
    "type": "object",
    "properties": {
        "MCPGatewayRequest": {
            "$ref": "#/definitions/MCPGatewayRequest"
        },
        "MCPGatewayResponse": {
            "$ref": "#/definitions/MCPGatewayResponse"
        },
        "MCPGatewayPolicyConfig": {
            "$ref": "#/definitions/MCPGatewayPolicyConfig"
        }
    },
    "definitions": {
        "Record<string,any>": {
            "type": "object",
            "additionalProperties": false
        },
        "MCPGatewayRequest": {
            "type": "object",
            "properties": {
                "request_id": {
                    "type": "string"
                },
                "timestamp": {
                    "type": "string"
                },
                "source": {
                    "type": "string"
                },
                "server_id": {
                    "type": "string"
                },
                "method": {
                    "type": "string"
                },
                "params": {
                    "$ref": "#/definitions/Record<string,any>"
                },
                "context": {
                    "$ref": "#/definitions/Record<string,any>"
                }
            },
            "additionalProperties": false,
            "required": [
                "method",
                "request_id",
                "server_id",
                "timestamp"
            ],
            "$schema": "http://json-schema.org/draft-07/schema#"
        },
        "GatewayApproval": {
            "type": "object",
            "properties": {
                "approval_id": {
                    "type": "string"
                },
                "required_role": {
                    "type": "string"
                },
                "reason": {
                    "type": "string"
                }
            },
            "additionalProperties": false
        },
        "MCPGatewayResponse": {
            "type": "object",
            "properties": {
                "request_id": {
                    "type": "string"
                },
                "timestamp": {
                    "type": "string"
                },
                "decision": {
                    "enum": [
                        "allow",
                        "deny",
                        "require_approval",
                        "warn"
                    ],
                    "type": "string"
                },
                "warnings": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "violations": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "approval": {
                    "$ref": "#/definitions/GatewayApproval"
                },
                "rewritten_request": {
                    "$ref": "#/definitions/Record<string,any>"
                }
            },
            "additionalProperties": false,
            "required": [
                "decision",
                "request_id",
                "timestamp"
            ],
            "$schema": "http://json-schema.org/draft-07/schema#"
        },
        "MCPGatewayRule": {
            "type": "object",
            "properties": {
                "match": {
                    "$ref": "#/definitions/Record<string,any>"
                },
                "action": {
                    "type": "string"
                },
                "metadata": {
                    "$ref": "#/definitions/Record<string,any>"
                }
            },
            "additionalProperties": false,
            "required": [
                "action",
                "match"
            ]
        },
        "MCPGatewayPolicyConfig": {
            "type": "object",
            "properties": {
                "opa_policies": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "onnx_models": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "rules": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/MCPGatewayRule"
                    }
                }
            },
            "additionalProperties": false,
            "$schema": "http://json-schema.org/draft-07/schema#"
        }
    }
}